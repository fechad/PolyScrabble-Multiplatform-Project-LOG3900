<div class="page-container mat-app-background" [class.mat-app-background]="themeService.darkThemeSelected">
    <div class="page-body">
        <app-hearder></app-hearder>

        <div class="body-main-container">
            <div class="page-title">
                <div class="form-title" [translate]="'CLASSIC.JOIN-MULTI.TITLE'"></div>
                <hr style="margin-top: 0%; background-color: black" width="35%" size="1" />
            </div>

            <div class="column-grid" [class.two]="roomsToShow.length > 1">
                <div *ngFor="let room of roomsToShow">
                    <div class="game">
                        <div class="game-info-container">
                            <div class="game-info">
                                <i class="fa fa-id-card game-info-icon"></i>
                                <div class="game-info-value">{{ room?.botsLevel }}</div>
                            </div>
                            <div class="right-icons">
                                <div class="game-info">
                                    <span class="material-symbols-outlined game-info-icon"> Alarm </span>
                                    <div class="game-info-value">{{ getFormattedTimerPerTurn(room) }}</div>
                                </div>
                                <div class="game-info">
                                    <i class="fa fa-eye game-info-icon"></i>
                                    <div class="game-info-value">{{ room.observers.length }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="game-body">
                            <div class="game-players">
                                <img
                                    class="avatar"
                                    [src]="room.players[0] ? room.players[0].clientAccountInfo.userSettings.avatarUrl : botAvatarUrl"
                                />
                                <img
                                    class="avatar"
                                    [src]="room.players[1] ? room.players[1].clientAccountInfo.userSettings.avatarUrl : botAvatarUrl"
                                />
                                <img
                                    class="avatar"
                                    [src]="room.players[2] ? room.players[2].clientAccountInfo.userSettings.avatarUrl : botAvatarUrl"
                                />
                                <img
                                    class="avatar"
                                    [src]="room.players[3] ? room.players[3].clientAccountInfo.userSettings.avatarUrl : botAvatarUrl"
                                />
                            </div>
                            <div class="game-buttons">
                                <button
                                    *ngIf="room.roomInfo.isPublic && room.roomInfo.password.length > 0"
                                    class="button"
                                    (click)="openPasswordPopup(room, roomPasswordPopup, darkBackground)"
                                    [disabled]="isInRoom || room.roomInfo.gameType !== room.roomInfo.gameType"
                                    [translate]="'CLASSIC.JOIN-MULTI.BUTTON-LOCK'"
                                >
                                    {{ joinPopUpText }} [KEY]
                                </button>
                                <button
                                    *ngIf="room.roomInfo.isPublic && room.roomInfo.password.length === 0"
                                    class="button"
                                    (click)="joinRoom('', room)"
                                    [disabled]="isInRoom || room.roomInfo.gameType !== room.roomInfo.gameType"
                                    [translate]="'CLASSIC.JOIN-MULTI.BUTTON'"
                                >
                                    {{ joinPopUpText }}
                                </button>
                                <button
                                    *ngIf="!room.roomInfo.isPublic"
                                    class="button"
                                    (click)="askToJoinRoom(room)"
                                    [disabled]="isInRoom || room.roomInfo.gameType !== room.roomInfo.gameType"
                                    [translate]="'CLASSIC.JOIN-MULTI.BUTTON-LOCK'"
                                >
                                    {{ joinPopUpText }} [ASK]
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer"></div>
    </div>

    <div #darkBackground class="dark-background">
        <div #roomPasswordPopup class="room-password-popup">
            <div class="pop-up-title" [translate]="'CLASSIC.JOIN-MULTI.POPUP.TITLE'"></div>
            <div [translate]="'CLASSIC.JOIN-MULTI.POPUP.BODY'"></div>
            <input #roomPasswordInput class="simple-input" type="password" placeholder="{{ 'CLASSIC.JOIN-MULTI.POPUP.INPUT' | translate }}" />
            <div class="buttons-container">
                <button
                    (click)="closePasswordPopup(roomPasswordPopup, darkBackground)"
                    class="button cancel-button popup"
                    [translate]="'OTHER.QUIT'"
                ></button>
                <button (click)="joinRoom(roomPasswordInput.value)" class="button popup" [translate]="'OTHER.JOIN'"></button>
            </div>
        </div>
    </div>
    <app-menu></app-menu>
</div>
